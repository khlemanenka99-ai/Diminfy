
{% extends 'base.html' %}
{% load static %}

{% block title %}–ü–ª–µ–π –ª–∏—Å—Ç{% endblock %}

{% block content %}
<h1 class="mb-4">–ü–ª–µ–π –ª–∏—Å—Ç</h1>
    <!-- –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º -->
    <div class="mb-3">
        <strong>–ñ–∞–Ω—Ä—ã:</strong>
        <a href="{% url 'songs' %}"
           class="btn btn-sm {% if not selected_genre %}btn-success{% else %}btn-outline-success{% endif %}">–í—Å–µ</a>
        {% for genre in genres %}
            <a href="?genre={{ genre.id }}"
               class="btn btn-sm {% if genre.id|stringformat:"s" == selected_genre %}btn-success{% else %}btn-outline-success{% endif %}">
                {{ genre.name }}
            </a>
        {% endfor %}
    </div>
    <!-- –ü–æ–∏—Å–∫ -->
    <form method="get" class="text-center mb-4">
        <div class="input-group w-50 mx-auto">
            <input type="text" name="q" value="{{ request.GET.q }}" placeholder="–ü–æ–∏—Å–∫ –ø–æ –ø–µ—Å–Ω–µ –∏–ª–∏ –∞—Ä—Ç–∏—Å—Ç—É..."
                   class="form-control border-success">
            <button class="btn btn-success" type="submit">üîç –ù–∞–π—Ç–∏</button>
        </div>
    </form>
    <!-- –°–ø–∏—Å–æ–∫ –ø–µ—Å–µ–Ω -->
    <div class="d-flex flex-column align-items-center">
        {% for song in songs %}
            <div class="card mb-3 shadow-sm" style="width: 50%;">
                <div class="row g-0">
                    <div class="col-md-4">
                        {% if song.album.cover %}
                            <img src="{{ song.album.cover.url }}" class="img-fluid rounded-start"
                                 alt="{{ song.title }}">
                        {% else %}
                            <img src="{% static 'no-image.png' %}" class="img-fluid rounded-start"
                                 alt="–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">
                        {% endif %}
                    </div>
                    <div class="col-md-8">
                        <div class="card-body">
                            <h5 class="card-title">{{ song.title }}</h5>
                            <p class="card-text">
                                <strong>–ê—Ä—Ç–∏—Å—Ç:</strong> {{ song.artist.name }} <br>
                                <strong>–ê–ª—å–±–æ–º:</strong> {{ song.album.title }} <br>
                                <strong>–ñ–∞–Ω—Ä:</strong> {{ song.genre.name }}
                            </p>
                            {% if song.audiofile %}
                            <audio controls preload="none" style="width: 100%;">
                                <source src="{{ song.file.url }}" type="audio/mpeg">
                                –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ.
                            </audio>
                            {% else %}
                            <p class="text-muted">–ê—É–¥–∏–æ—Ñ–∞–π–ª –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç</p>
                            {% endif %}
                            <form action="{% url 'add_to_like_songs' song.id %}" method="post">
                                {% csrf_token %}
                                <button type="submit">–î–æ–±–∞–≤–∏—Ç—å –≤ –ª—é–±–∏–º–æ–µ</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        {% empty %}
            <p>–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–µ—Å–µ–Ω.</p>
        {% endfor %}
    </div>
{% endblock %}
